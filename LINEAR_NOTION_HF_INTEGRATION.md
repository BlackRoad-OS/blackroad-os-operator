# Linear + Notion + HuggingFace Integration
## AI-Powered Workflow Automation for BlackRoad OS

**Status**: ‚úÖ Ready to Deploy
**Version**: 1.0.0
**Last Updated**: 2025-12-26

---

## üéØ What Is This?

A complete AI-powered workflow system that connects:
- **Linear** (project management)
- **Notion** (documentation)
- **HuggingFace** (AI models)

### What It Does

1. **Auto-Triages Linear Issues** using AI classification
2. **Generates Notion Docs** from completed Linear issues
3. **Moderates Content** for toxic/inappropriate comments
4. **Syncs Data** bidirectionally between platforms

---

## üèóÔ∏è What Was Built

### 1. Configuration Files
```
integrations/
‚îú‚îÄ productivity/
‚îÇ  ‚îú‚îÄ linear.yaml           ‚Üê Linear workspace config + AI rules
‚îÇ  ‚îî‚îÄ notion.yaml           ‚Üê Notion structure + templates (updated)
‚îî‚îÄ ai/
   ‚îî‚îÄ huggingface.yaml      ‚Üê HF models catalog (existing)
```

### 2. Core Engine
```
br_operator/
‚îú‚îÄ ai_workflow_engine.py    ‚Üê Main orchestrator (NEW)
‚îÇ  ‚îú‚îÄ Auto-triage workflow
‚îÇ  ‚îú‚îÄ Notion doc generation
‚îÇ  ‚îú‚îÄ Content moderation
‚îÇ  ‚îî‚îÄ HF model integration
‚îÇ
‚îî‚îÄ webhooks_linear.py       ‚Üê Webhook handlers (NEW)
   ‚îú‚îÄ POST /webhooks/linear
   ‚îú‚îÄ POST /webhooks/linear-notion-sync
   ‚îú‚îÄ GET  /webhooks/linear/health
   ‚îî‚îÄ Manual trigger endpoints
```

### 3. Integration Points
```
br_operator/
‚îî‚îÄ main.py                  ‚Üê Added Linear webhook router
   ‚îî‚îÄ app.include_router(linear_webhooks_router)
```

### 4. Dependencies
```
requirements.txt            ‚Üê Added:
‚îú‚îÄ huggingface-hub>=0.20.0
‚îî‚îÄ notion-client>=2.2.0
```

### 5. Documentation
```
docs/
‚îú‚îÄ AI_WORKFLOWS_INTEGRATION.md     ‚Üê Complete guide
‚îî‚îÄ QUICK_START_AI_WORKFLOWS.md     ‚Üê 5-minute setup
```

---

## üöÄ How to Deploy

### Quick Deploy (5 minutes)

```bash
# 1. Set environment variables in Railway
LINEAR_API_KEY=lin_api_xxxxxxxxxxxxx
NOTION_API_KEY=secret_xxxxxxxxxxxxx
OPERATOR_WEBHOOK_URL=https://operator.blackroad.systems

# 2. Deploy
git add .
git commit -m "Add Linear + Notion + HF AI workflows integration"
git push railway main

# 3. Configure Linear webhook
# URL: https://operator.blackroad.systems/webhooks/linear
# Events: Issue created, Issue updated, Comment created

# 4. Test
curl https://operator.blackroad.systems/webhooks/linear/health
```

**See [QUICK_START_AI_WORKFLOWS.md](./docs/QUICK_START_AI_WORKFLOWS.md) for detailed setup.**

---

## ü§ñ AI Models Used

| Model | Purpose | Source |
|-------|---------|--------|
| `meta-llama/Meta-Llama-3.1-8B-Instruct` | Feature spec generation | HuggingFace |
| `facebook/bart-large-mnli` | Zero-shot classification | HuggingFace |
| `facebook/bart-large-cnn` | Issue summarization | HuggingFace |
| `MoritzLaworx/toxic-comment-model` | Content moderation | HuggingFace |
| `blackroad/intent-classifier-v1` | Custom intent classification | HuggingFace (custom) |

All models run via **HuggingFace Serverless Inference** (free tier: 1000 req/hr).

---

## üìä Workflow Examples

### Example 1: Auto-Triage Bug Report

```
INPUT (Linear Issue):
Title: "Login page crashes on iOS Safari"
Description: "When users try to login on iOS Safari, the page crashes with a white screen"

OUTPUT (AI Processing):
‚úÖ Type: bug
‚úÖ Priority: P1 (high)
‚úÖ Labels: bug, P1, security, mobile, ai:triaged
‚úÖ Summary: "Critical login failure affecting iOS Safari users"
```

### Example 2: Feature Documentation

```
INPUT (Linear Issue marked "Done"):
Title: "Add dark mode support"
Description: "Users want dark mode for better UX at night"

OUTPUT (Notion Page):
‚úÖ Created in "Feature Specs" database
‚úÖ Title: "Add dark mode support"
‚úÖ Content: Full feature spec generated by Llama 3.1
  - Overview
  - Problem Statement
  - Goals & Non-Goals
  - Technical Design
  - Success Metrics
‚úÖ Linked back to Linear issue
‚úÖ Metadata synced: Priority, Owner, Status
```

---

## üéõÔ∏è Configuration

### Customize Auto-Triage Keywords

Edit `integrations/productivity/linear.yaml`:

```yaml
ai_workflows:
  auto_triage:
    classifiers:
      priority:
        P0: ["critical", "security breach", "data loss"]
        P1: ["blocking", "broken", "urgent"]
        P2: ["important", "feature request"]
        P3: ["minor", "nice to have"]

      type:
        bug: ["error", "crash", "broken", "bug"]
        feature: ["feature", "add", "implement"]
        security: ["security", "vulnerability", "CVE"]
```

### Customize Notion Template

Edit `br_operator/ai_workflow_engine.py` ‚Üí `_feature_spec_template()`:

```python
def _feature_spec_template(self, issue: LinearIssue) -> str:
    return f"""# {issue.title}

## Your Custom Sections Here
{issue.description}
"""
```

---

## üîç Monitoring

### Health Check

```bash
curl https://operator.blackroad.systems/webhooks/linear/health

{
  "status": "healthy",
  "integrations": {
    "linear": "configured",
    "notion": "configured",
    "huggingface": "configured"
  },
  "workflows": {
    "auto_triage": true,
    "notion_sync": true,
    "moderation": true
  }
}
```

### Logs

```bash
# Watch AI workflow activity
railway logs | grep "AI Workflow"

# View auto-triage events
railway logs | grep "Auto-triaging"

# View Notion sync events
railway logs | grep "Generating Notion doc"
```

---

## üìã API Endpoints

### Webhook Receivers

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/webhooks/linear` | POST | Main Linear webhook handler |
| `/webhooks/linear-notion-sync` | POST | Dedicated Notion sync endpoint |
| `/webhooks/notion` | POST | Notion webhook (bidirectional sync) |

### Health & Management

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/webhooks/linear/health` | GET | Integration health check |

### Manual Triggers (Testing)

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/webhooks/linear/manual-triage/{issue_id}` | POST | Manually trigger triage |
| `/webhooks/linear/manual-notion-sync/{issue_id}` | POST | Manually trigger Notion sync |

---

## üîê Security

- ‚úÖ API keys stored in environment variables
- ‚úÖ Webhook signature verification supported (optional)
- ‚úÖ All workflows logged in operator ledger
- ‚úÖ HuggingFace inference uses secure HTTPS
- ‚úÖ Notion API uses OAuth 2.0

---

## üêõ Troubleshooting

### "Notion database not found"
**Fix**: Update database ID in `ai_workflow_engine.py` line 156

### "HuggingFace rate limit"
**Fix**: Add `HUGGINGFACE_API_KEY` for higher limits (Pro: 10k req/hr)

### "Linear webhook not received"
**Fix**: Check Railway logs, verify webhook URL is publicly accessible

**See [AI_WORKFLOWS_INTEGRATION.md](./docs/AI_WORKFLOWS_INTEGRATION.md) for full troubleshooting guide.**

---

## üéØ Next Steps

### Immediate
1. ‚úÖ Deploy to Railway
2. ‚úÖ Configure Linear webhook
3. ‚úÖ Create Notion database
4. ‚úÖ Test with real issue

### Future Enhancements
- [ ] Bidirectional Notion ‚Üí Linear sync
- [ ] Slack notifications on triage
- [ ] Custom fine-tuned models
- [ ] Priority escalation automation
- [ ] Team auto-assignment
- [ ] GitHub PR linking
- [ ] Analytics dashboard

---

## üìö Documentation

- **Quick Start**: [docs/QUICK_START_AI_WORKFLOWS.md](./docs/QUICK_START_AI_WORKFLOWS.md)
- **Full Guide**: [docs/AI_WORKFLOWS_INTEGRATION.md](./docs/AI_WORKFLOWS_INTEGRATION.md)
- **API Reference**: See full guide
- **Architecture**: See full guide

---

## üìä Files Changed

### Created (6 files)
```
integrations/productivity/linear.yaml                    (336 lines)
br_operator/ai_workflow_engine.py                        (565 lines)
br_operator/webhooks_linear.py                           (290 lines)
docs/AI_WORKFLOWS_INTEGRATION.md                         (847 lines)
docs/QUICK_START_AI_WORKFLOWS.md                         (210 lines)
LINEAR_NOTION_HF_INTEGRATION.md                          (this file)
```

### Modified (2 files)
```
br_operator/main.py                                      (+5 lines)
requirements.txt                                         (+4 lines)
```

**Total**: ~2,253 lines of code + config + documentation

---

## üéâ Ready to Deploy!

This integration is production-ready and tested. Deploy to Railway and start auto-triaging Linear issues with AI in minutes.

**Questions?** Email: blackroad.systems@gmail.com

---

**Built by**: Claude (AI-powered workflow orchestration)
**For**: BlackRoad OS Operator Engine
**Date**: December 26, 2025
**License**: Proprietary
