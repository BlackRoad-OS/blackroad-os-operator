# secrets.aliases.yaml
# BlackRoad OS - Secret Alias Registry
#
# This file is SAFE TO COMMIT - it contains NO actual secrets.
# It maps logical aliases to environment variable names.
#
# Pattern: Only the Operator holds real secrets.
# Everyone else (agents, workers, packs) uses aliases via governed API calls.
#
# @amundson 0.1.0

version: "secrets-v1"

# Where secrets actually live (the "secrets perimeter")
perimeter:
  production:
    - service: blackroad-cece-operator
      platform: railway
      project_id: d8eed902-91eb-44f6-aa5c-68acf0328ace

  local:
    - file: ~/.blackroad/secrets.env
    - file: .env

# =============================================================================
# LLM PROVIDERS
# =============================================================================

providers:
  openai:
    default:
      env_var: OPENAI_API_KEY
      description: "Primary OpenAI key for Cece operator"
      required: true
      used_by:
        - br_operator.llm_service
        - intents.*

    embeddings:
      env_var: OPENAI_API_KEY  # Same key, different alias for clarity
      description: "OpenAI embeddings for RAG"
      required: false

  anthropic:
    default:
      env_var: ANTHROPIC_API_KEY
      description: "Anthropic Claude API for multi-model routing"
      required: false
      used_by:
        - br_operator.llm_service

  ollama:
    local:
      env_var: OLLAMA_HOST
      description: "Local Ollama endpoint (not a secret, but consistent pattern)"
      default: "http://localhost:11434"
      required: false

# =============================================================================
# INFRASTRUCTURE
# =============================================================================

  cloudflare:
    api_token:
      env_var: CLOUDFLARE_API_TOKEN
      description: "Cloudflare API token for Workers/KV/D1"
      required: false
      used_by:
        - infra.deploy

    account_id:
      env_var: CLOUDFLARE_ACCOUNT_ID
      description: "Cloudflare account ID"
      required: false

  railway:
    token:
      env_var: RAILWAY_TOKEN
      description: "Railway API token for deployments"
      required: false

  digitalocean:
    token:
      env_var: DIGITALOCEAN_ACCESS_TOKEN
      description: "DigitalOcean API token"
      required: false

    ssh_key:
      env_var: DROPLET_SSH_KEY
      description: "SSH private key for droplet access"
      required: false
      sensitive: true

# =============================================================================
# PAYMENTS & BILLING
# =============================================================================

  stripe:
    secret:
      env_var: STRIPE_SECRET_KEY
      description: "Stripe secret key for billing"
      required: false
      used_by:
        - workers.billing
        - gateway.stripe-worker

    publishable:
      env_var: STRIPE_PUBLISHABLE_KEY
      description: "Stripe publishable key (client-safe)"
      required: false
      sensitive: false  # Can be exposed to frontend

    webhook_secret:
      env_var: STRIPE_WEBHOOK_SECRET
      description: "Stripe webhook signing secret"
      required: false

# =============================================================================
# INTEGRATIONS
# =============================================================================

  github:
    token:
      env_var: GITHUB_TOKEN
      description: "GitHub personal access token"
      required: false
      used_by:
        - agents.github

    app_private_key:
      env_var: GITHUB_APP_PRIVATE_KEY
      description: "GitHub App private key for org-level access"
      required: false
      sensitive: true

  slack:
    bot_token:
      env_var: SLACK_BOT_TOKEN
      description: "Slack bot OAuth token"
      required: false
      used_by:
        - agents.slack
        - notifications

    webhook_url:
      env_var: SLACK_WEBHOOK_URL
      description: "Slack incoming webhook for alerts"
      required: false

  notion:
    api_key:
      env_var: NOTION_API_KEY
      description: "Notion integration token"
      required: false
      used_by:
        - agents.notion
        - packs.research

  linear:
    api_key:
      env_var: LINEAR_API_KEY
      description: "Linear API key for issue tracking"
      required: false
      used_by:
        - agents.linear

  asana:
    token:
      env_var: ASANA_ACCESS_TOKEN
      description: "Asana personal access token"
      required: false

# =============================================================================
# DATABASES
# =============================================================================

  postgres:
    url:
      env_var: DATABASE_URL
      description: "Primary PostgreSQL connection string"
      required: false
      sensitive: true

  redis:
    url:
      env_var: REDIS_URL
      description: "Redis connection string"
      required: false

  pinecone:
    api_key:
      env_var: PINECONE_API_KEY
      description: "Pinecone vector DB API key"
      required: false

# =============================================================================
# INTERNAL / MESH
# =============================================================================

  blackroad:
    internal_signing_key:
      env_var: BR_INTERNAL_SIGNING_KEY
      description: "Internal JWT signing key for service-to-service auth"
      required: false
      sensitive: true

    webhook_secret:
      env_var: BR_WEBHOOK_SECRET
      description: "Secret for validating incoming webhooks"
      required: false

# =============================================================================
# GOVERNANCE
# =============================================================================

# Which aliases require policy evaluation before use
governed_aliases:
  - openai.default
  - anthropic.default
  - stripe.secret
  - github.token
  - notion.api_key
  - slack.bot_token

# Aliases that can be used without policy check (internal/infra)
ungovened_aliases:
  - cloudflare.api_token
  - railway.token
  - postgres.url
  - redis.url
  - blackroad.internal_signing_key
