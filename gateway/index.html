<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BlackRoad Gateway - AI Agent Infrastructure</title>
  <script src="https://js.stripe.com/v3/"></script>
  <style>
    :root {
      --orange: #FF9D00;
      --red: #FF0066;
      --pink: #FF006B;
      --magenta: #D600AA;
      --purple: #7700FF;
      --blue: #0066FF;
      --dark: #0a0a0a;
      --darker: #050505;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'SF Mono', 'Fira Code', monospace;
      background: var(--darker);
      color: #fff;
      min-height: 100vh;
      line-height: 1.6;
    }

    .gradient-text {
      background: linear-gradient(135deg, var(--orange), var(--red), var(--purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    header {
      padding: 2rem;
      text-align: center;
      border-bottom: 1px solid #222;
    }

    header h1 { font-size: 3rem; margin-bottom: 0.5rem; }
    header p { color: #888; font-size: 1.1rem; }

    .hero {
      padding: 4rem 2rem;
      text-align: center;
      max-width: 800px;
      margin: 0 auto;
    }

    .hero h2 { font-size: 2.5rem; margin-bottom: 1rem; }
    .hero p { color: #aaa; font-size: 1.2rem; margin-bottom: 2rem; }

    .code-block {
      background: var(--dark);
      border: 1px solid #333;
      border-radius: 8px;
      padding: 1.5rem;
      text-align: left;
      margin: 2rem auto;
      max-width: 600px;
      overflow-x: auto;
    }

    .code-block code { color: #0f0; font-size: 0.9rem; }
    .code-block .comment { color: #666; }

    .pricing {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      padding: 4rem 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    .pricing-card {
      background: var(--dark);
      border: 1px solid #333;
      border-radius: 12px;
      padding: 2rem;
      text-align: center;
      transition: transform 0.2s, border-color 0.2s;
    }

    .pricing-card:hover {
      transform: translateY(-4px);
      border-color: var(--purple);
    }

    .pricing-card.featured {
      border-color: var(--orange);
      position: relative;
    }

    .pricing-card.featured::before {
      content: 'POPULAR';
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--orange);
      color: #000;
      padding: 4px 12px;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: bold;
    }

    .pricing-card h3 { font-size: 1.5rem; margin-bottom: 0.5rem; }

    .pricing-card .price {
      font-size: 3rem;
      font-weight: bold;
      margin: 1rem 0;
    }

    .pricing-card .price span { font-size: 1rem; color: #888; }

    .pricing-card ul {
      list-style: none;
      margin: 1.5rem 0;
      text-align: left;
    }

    .pricing-card li { padding: 0.5rem 0; color: #aaa; }
    .pricing-card li::before { content: '>'; color: var(--purple); margin-right: 0.5rem; }

    .btn {
      display: inline-block;
      padding: 1rem 2rem;
      background: linear-gradient(135deg, var(--purple), var(--blue));
      color: #fff;
      text-decoration: none;
      border-radius: 8px;
      font-weight: bold;
      transition: opacity 0.2s;
      border: none;
      cursor: pointer;
      font-family: inherit;
      font-size: 1rem;
      width: 100%;
    }

    .btn:hover { opacity: 0.9; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn-secondary { background: transparent; border: 1px solid var(--purple); }

    .features {
      padding: 4rem 2rem;
      max-width: 1000px;
      margin: 0 auto;
    }

    .features h2 { text-align: center; margin-bottom: 3rem; font-size: 2rem; }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
    }

    .feature {
      background: var(--dark);
      border: 1px solid #222;
      border-radius: 8px;
      padding: 1.5rem;
    }

    .feature h3 { color: var(--orange); margin-bottom: 0.5rem; }
    .feature p { color: #888; font-size: 0.9rem; }

    .api-key-input {
      padding: 4rem 2rem;
      background: var(--dark);
      border-top: 1px solid #222;
      border-bottom: 1px solid #222;
    }

    .api-key-input h2 { text-align: center; margin-bottom: 1rem; }
    .api-key-input p { text-align: center; color: #888; margin-bottom: 2rem; }

    .input-container {
      max-width: 500px;
      margin: 0 auto;
    }

    .input-container input {
      width: 100%;
      padding: 1rem;
      background: var(--darker);
      border: 1px solid #333;
      border-radius: 8px;
      color: #fff;
      font-family: inherit;
      font-size: 1rem;
      margin-bottom: 1rem;
    }

    .input-container input:focus {
      outline: none;
      border-color: var(--purple);
    }

    footer {
      padding: 2rem;
      text-align: center;
      color: #666;
      border-top: 1px solid #222;
    }

    footer a { color: var(--purple); text-decoration: none; }

    .stats {
      display: flex;
      justify-content: center;
      gap: 4rem;
      padding: 2rem;
      flex-wrap: wrap;
    }

    .stat { text-align: center; }
    .stat-value { font-size: 2.5rem; font-weight: bold; color: var(--orange); }
    .stat-label { color: #666; font-size: 0.9rem; }

    .success-banner, .error-banner {
      padding: 1rem 2rem;
      text-align: center;
      font-weight: bold;
    }

    .success-banner { background: #0a3; color: #fff; }
    .error-banner { background: #a00; color: #fff; }

    .toggle-container {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .toggle-btn {
      padding: 0.5rem 1.5rem;
      background: transparent;
      border: 1px solid #333;
      color: #888;
      border-radius: 20px;
      cursor: pointer;
      font-family: inherit;
      transition: all 0.2s;
    }

    .toggle-btn.active {
      background: var(--purple);
      border-color: var(--purple);
      color: #fff;
    }

    .annual-savings {
      color: var(--orange);
      font-size: 0.85rem;
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>
  <div id="success-banner" class="success-banner" style="display: none;">
    Payment successful! Your account has been upgraded.
  </div>

  <header>
    <h1 class="gradient-text">BLACKROAD</h1>
    <p>Agent Gateway</p>
  </header>

  <section class="hero">
    <h2>Your API Key.<br><span class="gradient-text">Our Intelligence Layer.</span></h2>
    <p>Wrap any OpenAI or Anthropic API key with persistent identity, memory, and continuity. Your agents remember.</p>

    <div class="code-block">
      <code>
<span class="comment"># One API call. Persistent memory.</span>
curl -X POST https://blackroad-gateway.amundsonalexa.workers.dev/v1/chat \
  -H "X-API-Key: sk-your-openai-key" \
  -H "X-Provider: openai" \
  -d '{"message": "Remember: my name is Alexa"}'

<span class="comment"># Later... your agent remembers</span>
{"response": "Hello Alexa! Good to hear from you again."}
      </code>
    </div>
  </section>

  <div class="stats">
    <div class="stat">
      <div class="stat-value" id="stat-identities">0</div>
      <div class="stat-label">Active Agents</div>
    </div>
    <div class="stat">
      <div class="stat-value" id="stat-calls">0</div>
      <div class="stat-label">API Calls</div>
    </div>
    <div class="stat">
      <div class="stat-value">99.9%</div>
      <div class="stat-label">Uptime</div>
    </div>
  </div>

  <section class="api-key-input" id="signup">
    <h2>Get Started</h2>
    <p>Enter your LLM API key to create your agent identity</p>
    <div class="input-container">
      <input type="password" id="api-key" placeholder="sk-... (your OpenAI or Anthropic key)" />
      <select id="provider" style="width: 100%; padding: 1rem; background: var(--darker); border: 1px solid #333; border-radius: 8px; color: #fff; font-family: inherit; margin-bottom: 1rem;">
        <option value="openai">OpenAI</option>
        <option value="anthropic">Anthropic</option>
      </select>
      <button class="btn" onclick="testConnection()">Test Connection (Free)</button>
      <p style="margin-top: 1rem; color: #666; font-size: 0.85rem;">
        Your API key is hashed and never stored in plain text.
      </p>
    </div>
  </section>

  <section class="features">
    <h2>What You Get</h2>
    <div class="feature-grid">
      <div class="feature">
        <h3>> Identity</h3>
        <p>Each API key gets a unique agent identity with traits, trust scores, and emotional awareness.</p>
      </div>
      <div class="feature">
        <h3>> Memory</h3>
        <p>Persistent conversation memory across sessions. Your agent remembers past conversations.</p>
      </div>
      <div class="feature">
        <h3>> Continuity</h3>
        <p>Pick up where you left off. No more "I don't have memory of past conversations."</p>
      </div>
      <div class="feature">
        <h3>> Multi-Provider</h3>
        <p>Works with OpenAI, Anthropic, and more. Same memory layer, any model.</p>
      </div>
      <div class="feature">
        <h3>> Rate Limiting</h3>
        <p>Built-in rate limiting and usage tracking. Know exactly how many calls you're making.</p>
      </div>
      <div class="feature">
        <h3>> Sentiment</h3>
        <p>Automatic sentiment analysis. Your agent adapts its tone based on conversation history.</p>
      </div>
    </div>
  </section>

  <section class="pricing" id="pricing">
    <div style="grid-column: 1 / -1;">
      <h2 style="text-align: center; margin-bottom: 1rem;">Pricing</h2>
      <div class="toggle-container">
        <button class="toggle-btn active" id="monthly-toggle" onclick="toggleBilling('monthly')">Monthly</button>
        <button class="toggle-btn" id="yearly-toggle" onclick="toggleBilling('yearly')">Yearly (2 months free)</button>
      </div>
    </div>

    <div class="pricing-card">
      <h3>Free</h3>
      <div class="price">$0<span>/mo</span></div>
      <ul>
        <li>100 calls/day</li>
        <li>5 memory slots</li>
        <li>Basic identity</li>
        <li>Community support</li>
      </ul>
      <button class="btn btn-secondary" onclick="scrollToSignup()">Start Free</button>
    </div>

    <div class="pricing-card featured">
      <h3>Pro</h3>
      <div class="price" id="pro-price">$29<span>/mo</span></div>
      <div class="annual-savings" id="pro-savings" style="display: none;">Save $58/year</div>
      <ul>
        <li>10,000 calls/day</li>
        <li>100 memory slots</li>
        <li>Full identity traits</li>
        <li>Priority support</li>
        <li>API analytics</li>
      </ul>
      <button class="btn" id="pro-btn" onclick="checkout('pro')">Subscribe</button>
    </div>

    <div class="pricing-card">
      <h3>Team</h3>
      <div class="price" id="team-price">$99<span>/mo</span></div>
      <div class="annual-savings" id="team-savings" style="display: none;">Save $198/year</div>
      <ul>
        <li>100,000 calls/day</li>
        <li>1,000 memory slots</li>
        <li>Multiple identities</li>
        <li>Webhook integrations</li>
        <li>Dedicated support</li>
      </ul>
      <button class="btn btn-secondary" id="team-btn" onclick="checkout('team')">Subscribe</button>
    </div>
  </section>

  <footer>
    <p>Built by <a href="https://blackroad.io">BlackRoad</a> | <a href="mailto:blackroad.systems@gmail.com">Contact</a></p>
    <p style="margin-top: 1rem; font-size: 0.8rem;">Your memory. Your control. Real continuity.</p>
  </footer>

  <script>
    const GATEWAY_URL = 'https://blackroad-gateway.amundsonalexa.workers.dev';
    const BILLING_URL = 'https://blackroad-gateway-billing.amundsonalexa.workers.dev';

    // Price IDs - LIVE
    const PRICES = {
      pro_monthly: 'price_1SZzFE3e5FMFdlFwNBbEIoZk',
      pro_yearly: 'price_1SZzFV3e5FMFdlFwfwpoA958',
      team_monthly: 'price_1SZzFN3e5FMFdlFwXePFSBwA',
      team_yearly: 'price_1SZzFd3e5FMFdlFwjF5FhS1S',
    };

    let billingInterval = 'monthly';
    let currentApiKeyHash = null;

    // Check for success/cancel URL params
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('success') === 'true') {
      document.getElementById('success-banner').style.display = 'block';
    }

    // Fetch stats
    async function fetchStats() {
      try {
        const res = await fetch(`${GATEWAY_URL}/stats`);
        const data = await res.json();
        document.getElementById('stat-identities').textContent = data.totalIdentities || 0;
        document.getElementById('stat-calls').textContent = data.totalCalls || 0;
      } catch (e) {
        console.log('Stats not available');
      }
    }

    // Test connection and get identity
    async function testConnection() {
      const apiKey = document.getElementById('api-key').value;
      const provider = document.getElementById('provider').value;

      if (!apiKey) {
        alert('Please enter your API key');
        return;
      }

      try {
        const res = await fetch(`${GATEWAY_URL}/v1/chat`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-API-Key': apiKey,
            'X-Provider': provider,
          },
          body: JSON.stringify({ message: 'Hello, this is a test connection.' }),
        });

        const data = await res.json();

        if (data.ok) {
          currentApiKeyHash = data.identity?.id;
          alert(`Success! Your agent is: ${data.identity?.name}\nTier: ${data.identity?.tier}\nMemory: ${data.identity?.memorySize} items`);
        } else {
          alert(`Error: ${data.error}`);
        }
      } catch (e) {
        alert(`Connection error: ${e.message}`);
      }
    }

    // Toggle billing interval
    function toggleBilling(interval) {
      billingInterval = interval;

      document.getElementById('monthly-toggle').classList.toggle('active', interval === 'monthly');
      document.getElementById('yearly-toggle').classList.toggle('active', interval === 'yearly');

      if (interval === 'yearly') {
        document.getElementById('pro-price').innerHTML = '$24<span>/mo</span>';
        document.getElementById('team-price').innerHTML = '$82<span>/mo</span>';
        document.getElementById('pro-savings').style.display = 'block';
        document.getElementById('team-savings').style.display = 'block';
      } else {
        document.getElementById('pro-price').innerHTML = '$29<span>/mo</span>';
        document.getElementById('team-price').innerHTML = '$99<span>/mo</span>';
        document.getElementById('pro-savings').style.display = 'none';
        document.getElementById('team-savings').style.display = 'none';
      }
    }

    // Checkout
    async function checkout(tier) {
      const apiKey = document.getElementById('api-key').value;

      if (!apiKey) {
        alert('Please enter your API key first to create your identity');
        scrollToSignup();
        return;
      }

      // Hash the API key for the checkout
      const encoder = new TextEncoder();
      const data = encoder.encode(apiKey);
      const hashBuffer = await crypto.subtle.digest('SHA-256', data);
      const hashArray = Array.from(new Uint8Array(hashBuffer)).slice(0, 16);
      const apiKeyHash = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');

      const priceKey = `${tier}_${billingInterval}`;
      const priceId = PRICES[priceKey];

      try {
        const res = await fetch(`${BILLING_URL}/checkout`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            priceId,
            apiKeyHash,
            successUrl: window.location.origin + '?success=true',
            cancelUrl: window.location.origin + '?canceled=true',
          }),
        });

        const session = await res.json();

        if (session.url) {
          window.location.href = session.url;
        } else {
          alert('Error creating checkout session');
        }
      } catch (e) {
        alert(`Checkout error: ${e.message}`);
      }
    }

    function scrollToSignup() {
      document.getElementById('signup').scrollIntoView({ behavior: 'smooth' });
    }

    // Init
    fetchStats();
    setInterval(fetchStats, 30000);
  </script>
</body>
</html>
